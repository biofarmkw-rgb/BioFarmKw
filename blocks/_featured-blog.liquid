{% liquid
  assign blog_object = block.settings.blog | default: blog
  assign articles = blog_object.articles

  assign slide_interval = block.settings.change_slides_speed | times: 1000.00
%}
<div class="block-main-wrapper">
  <slider-component
    class="article-slider slider"
    data-slide-desktop
    data-slide-mobile
    data-draggable
    data-slide-smooth
    data-looping
    {% if block.settings.auto_rotate %}
      data-autoplay
      data-interval="{{ slide_interval }}"
    {% endif %}
  >
    <div class="slider-container">
      <ul
        id="Slider-{{ section.id }}"
        class="slider-wrapper"
        style="--color-foreground: {{ block.settings.text_color.red }}, {{ block.settings.text_color.green }}, {{ block.settings.text_color.blue }};"
      >
        {%- for article in articles limit: 5 -%}
          <li id="Slide-{{ section.id }}-{{ forloop.index }}" class="slider-slide">
            <div class="featured-image media">
              {% render 'lazy-image',
                image_object: article.image,
                sizes: '(min-width: 750px) 50vw, 100vw',
                placeholder: 'image'
              %}
              <div
                class="media-content position-container position--bottom-{{ block.settings.alignment }} position-mobile--bottom-{{ block.settings.alignment_mobile }}"
                style="--alpha-background: {{ block.settings.overlay_opacity }}%;"
              >
                <div class="content-group width--medium text-align--{{ block.settings.alignment }} text-align-mobile--{{ block.settings.alignment_mobile }}">
                  {%- if block.settings.show_date or block.settings.show_author -%}
                    <div class="article-meta light">
                      {%- if block.settings.show_author -%}
                        <small>{{ article.author }}</small>
                      {%- endif -%}
                      {%- if block.settings.show_date and block.settings.show_author -%}
                        {% render 'icon-sets-basic', icon: 'dot' %}
                      {%- endif -%}
                      {%- if block.settings.show_date -%}
                        <small>{{ article.published_at | time_tag: format: 'date' }}</small>
                      {%- endif -%}
                    </div>
                  {%- endif -%}
                  <h3 class="article-title">{{ article.title }}</h3>
                  {%- if block.settings.show_excerpt -%}
                    <div class="article-excerpt light small-hide">
                      {{ article.excerpt | strip_html | truncatewords: 20 }}
                    </div>
                  {%- endif -%}
                  <a class="button button--small button--border" href="{{ article.url }}">
                    {{ 'general.read_more' | t }}
                  </a>
                </div>
              </div>
            </div>
          </li>
        {%- else -%}
          {%- for i in (1..5) -%}
            <li id="Slide-{{ section.id }}-{{ forloop.index }}" class="slider-slide">
              <div class="featured-image media">
                {{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}
                <div
                  class="media-content position-container position--bottom-{{ block.settings.alignment }} position-mobile--bottom-{{ block.settings.alignment_mobile }}"
                  style="--alpha-background: {{ block.settings.overlay_opacity }}%;"
                >
                  <div class="content-group width--medium text-align--{{ block.settings.alignment }} text-align-mobile--{{ block.settings.alignment_mobile }}">
                    {%- if block.settings.show_date or block.settings.show_author -%}
                      <div class="article-meta light">
                        {%- if block.settings.show_date -%}
                          <small>{{ 'onboarding.article_author' | t }}</small>
                        {%- endif -%}
                        {%- if block.settings.show_date and block.settings.show_author -%}
                          {% render 'icon-sets-basic', icon: 'dot' %}'
                        {%- endif -%}
                        {%- if block.settings.show_date -%}
                          <small>{{ 'onboarding.article_date' | t }}</small>
                        {%- endif -%}
                      </div>
                    {%- endif -%}
                    <h3 class="article-title">{{ 'onboarding.article_title' | t }}</h3>
                    {%- if block.settings.show_excerpt -%}
                      <div class="article-excerpt light small-hide">
                        {{ 'onboarding.article_content' | t }}
                      </div>
                    {%- endif -%}
                    <a class="button button--small button--border" role="link" aria-disabled="true">
                      {{ 'general.read_more' | t }}
                    </a>
                  </div>
                </div>
              </div>
            </li>
          {%- endfor -%}
        {%- endfor -%}
      </ul>
      {%- if block.settings.show_nav_buttons -%}
        {% render 'slider-nav-buttons', section_id: section.id %}
      {%- endif -%}
      {%- if block.settings.show_page_dots -%}
        {% render 'slider-page-dots',
          section_id: section.id,
          auto_rotate: block.settings.auto_rotate,
          slide_interval: slide_interval,
          is_small: true
        %}
      {%- endif -%}
    </div>
  </slider-component>
  <ul class="article-list list-unstyled{% if block.settings.custom_index_color %} custom-index-color{% endif %}">
    {%- for article in articles limit: 5 -%}
      <li class="article-item">
        {% render 'card-article',
          card_article: article,
          image_width: '200px',
          image_width_mobile: '200px',
          truncate_title: false,
          show_date: block.settings.show_date,
          show_author: block.settings.show_author,
          show_excerpt: block.settings.show_excerpt,
          show_tags: block.settings.show_tags,
          show_horizontal: true,
          show_index: block.settings.show_index,
          index: forloop.index
        %}
      </li>
    {%- else -%}
      {%- for i in (1..5) -%}
        <li class="article-item">
          {% render 'card-article',
            image_width: '200px',
            image_width_mobile: '200px',
            show_date: block.settings.show_date,
            show_author: block.settings.show_author,
            show_excerpt: block.settings.show_excerpt,
            show_tags: block.settings.show_tags,
            show_horizontal: true,
            show_index: block.settings.show_index,
            index: forloop.index
          %}
        </li>
      {%- endfor -%}
    {%- endfor -%}
  </ul>
</div>

{%- if articles.size > 5 and block.settings.show_view_more -%}
  <div class="view-more-wrapper text-align--center mt-4">
    <a
      class="button button--border"
      {% if blog_object != blank %}
        href="{{ blog_object.url }}"
      {% else %}
        role="link"
        aria-disabled="true"
      {% endif %}
    >
      {{ 'general.view_all' | t }}
      {% render 'icon-sets-basic', icon: 'right', class: 'caret-icon' %}
    </a>
  </div>
{%- endif -%}
{% schema %}
{
  "name": "t:blocks._featured-blog.name",
  "class": "featured-blog-block",
  "settings": [
    {
      "type": "blog",
      "id": "blog",
      "label": "t:sections.all.blog.label"
    },
    {
      "type": "checkbox",
      "id": "show_view_more",
      "label": "t:blocks._featured-blog.settings.show_view_more.label",
      "default": true
    },
    {
      "type": "header",
      "content": "t:sections.all.layout.header_slider.content"
    },
    {
      "type": "checkbox",
      "id": "show_nav_buttons",
      "label": "t:sections.all.slider.show_nav_buttons.label",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_page_dots",
      "label": "t:sections.all.slider.show_page_dots.label",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "auto_rotate",
      "label": "t:sections.all.slider.auto_rotate.label",
      "default": true
    },
    {
      "type": "range",
      "id": "change_slides_speed",
      "min": 3,
      "max": 15,
      "step": 1,
      "unit": "s",
      "label": "t:sections.all.slider.change_slides_speed.label",
      "default": 10,
      "visible_if": "{{ block.settings.auto_rotate }}"
    },
    {
      "type": "paragraph",
      "content": "t:blocks._featured-blog.settings.paragraph_content.content"
    },
    {
      "type": "text_alignment",
      "id": "alignment",
      "label": "t:sections.all.text-alignment.label",
      "default": "left"
    },
    {
      "type": "range",
      "id": "overlay_opacity",
      "label": "t:sections.all.image.image_overlay_opacity.label",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "%",
      "default": 30
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "t:sections.all.colors.foreground.label",
      "default": "#FFFFFF"
    },
    {
      "type": "header",
      "content": "t:blocks._featured-blog.settings.header_article_setting.content"
    },
    {
      "type": "checkbox",
      "id": "show_tags",
      "label": "t:sections.all.article.show_tags.label",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_date",
      "label": "t:sections.all.article.show_date.label",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_author",
      "label": "t:sections.all.article.show_author.label",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_excerpt",
      "label": "t:sections.all.article.show_excerpt.label",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "show_index",
      "label": "t:sections.all.article.show_index.label",
      "default": true
    },
    {
      "type": "header",
      "content": "t:sections.all.mobile.header_content"
    },
    {
      "type": "paragraph",
      "content": "t:blocks._featured-blog.settings.paragraph_content.content"
    },
    {
      "type": "text_alignment",
      "id": "alignment_mobile",
      "label": "t:sections.all.text-alignment.label",
      "default": "left"
    }
  ],
  "presets": [
    {
      "name": "t:blocks._featured-blog.presets.name"
    }
  ]
}
{% endschema %}
