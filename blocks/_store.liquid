<deferred-media class="store-map video-model-media deferred-media" data-load-when-visible>
  <div class="media-poster media">
    {% render 'lazy-image',
      image_object: block.settings.image_map,
      sizes: '(min-width: 750px) 900px, 100vw',
      placeholder: 'image'
    %}
  </div>

  {%- if block.settings.map_iframe != blank -%}
    <template>
      {{ block.settings.map_iframe }}
    </template>
  {%- endif -%}
</deferred-media>

{% comment %} Store information {% endcomment %}
<div class="store-info content-group color-{{ block.settings.color_scheme }} gradient">
  {%- if block.settings.image_store -%}
    <div class="store-image media media--landscape">
      {% render 'lazy-image', image_object: block.settings.image_store, sizes: '(min-width: 750px) 900px, 100vw' %}
    </div>
  {%- endif -%}
  <div class="store-name h4">{{ block.settings.name | escape }}</div>
  {%- if block.settings.description != blank -%}
    <div class="store-description rte light">
      {{ block.settings.description }}
    </div>
  {%- endif -%}
  {%- if block.settings.location != blank -%}
    <div class="store-location">
      {{ block.settings.location | escape }}
      {% liquid
        assign base_url = 'https://www.google.com/maps/dir/?api=1&destination='
        assign encoded_address = block.settings.location | url_encode
        assign map_url = base_url | append: encoded_address
      %}
      <a
        class="navigate-button button button--small button--icon button--pill"
        href="{{ map_url }}"
        target="_blank"
      >
        {%- render 'icon-sets-basic', icon: 'top-right' -%}
        <span class="visually-hidden">{{ 'accessibility.navigate' | t }}</span>
      </a>
    </div>
  {%- endif -%}
  {%- if block.settings.phone != blank -%}
    <div class="store-phone">
      {% render 'icon-sets', icon: 'phone' %}
      <a class="link link-text show-underline" href="tel:{{ block.settings.phone | escape }}" dir="ltr">
        {{ block.settings.phone | escape }}
      </a>
    </div>
  {%- endif -%}
  {%- if block.settings.hours != blank -%}
    <div class="store-hours">
      {% render 'icon-sets', icon: 'clock' %}
      <span class="text">{{ block.settings.hours | escape }}</span>
    </div>
  {%- endif -%}
</div>
{% schema %}
{
  "name": "t:blocks._store.name",
  "class": "store-block",
  "settings": [
    {
      "type": "image_picker",
      "id": "image_store",
      "label": "t:blocks._store.settings.image_store.label",
      "info": "t:blocks._store.settings.image.info"
    },
    {
      "type": "text",
      "id": "name",
      "label": "t:sections.all.store.name.label",
      "default": "Store Name"
    },
    {
      "type": "richtext",
      "id": "description",
      "label": "t:sections.all.text-content.description.label",
      "default": "<p>Add a description about your store</p>"
    },
    {
      "type": "text",
      "id": "location",
      "label": "t:sections.all.store.location.label",
      "default": "11102 Lakewood Blvd, Downey, CA 90241"
    },
    {
      "type": "text",
      "id": "phone",
      "label": "t:sections.all.store.phone.label",
      "default": "(000) 123-4567"
    },
    {
      "type": "text",
      "id": "hours",
      "label": "t:sections.all.store.hours.label",
      "default": "Mon-Fri: 9am - 5pm"
    },
    {
      "type": "image_picker",
      "id": "image_map",
      "label": "t:blocks._store.settings.image_map.label",
      "info": "t:blocks._store.settings.image_map.info"
    },
    {
      "type": "html",
      "id": "map_iframe",
      "label": "t:sections.all.store.map.label",
      "info": "t:sections.all.store.map.info"
    }
  ],
  "presets": [
    {
      "name": "t:blocks._store.presets.name"
    }
  ]
}
{% endschema %}
