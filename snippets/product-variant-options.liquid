{% doc %}
  Product Variant Options

  @description
  Displays the options for a product variant, such as color, size, or other selectable options.

  @param {string} section_id - Section Id
  @param {string} [product_form_id] - The form ID for the product.
  @param {object} option_with_values - The current product option object.
  @param {string} type - The display type of the option. Possible values: button|dropdown|color|image
  @param {boolean} [in_mini] - Whether the option is displayed in Mini Checkout.
  @param {boolean} [in_bundle] - Whether the option is displayed in a bundle product.
  @param {boolean} [unselectable_when_unavailable] - If true, options that are unavailable cannot be selected (default is selectable).

  @example
  {% render 'product-variant-options',
    option_with_values: option_with_values,
    type: 'button'
  %}
{% enddoc %}

{%- for value in option_with_values.values -%}
  {%- if type == 'color' or type == 'image' -%}
    <div class="color-swatch" data-toggle="tooltip" data-title="{{ value }}">
      <input
        {% if in_mini %}
          id="Mini-{{ section_id }}-{{ option_with_values.position }}-{{ forloop.index0 }}"
          name="_mini-{{ option_with_values.name }}"
          data-target="{{ section_id }}-{{ option_with_values.position }}-{{ forloop.index0 }}"
        {% elsif in_bundle %}
          id="Bundle-{{ section_id }}-{{ option_with_values.position }}-{{ forloop.index0 }}"
          name="_bundle-{{ option_with_values.name }}"
        {% else %}
          id="{{ section_id }}-{{ option_with_values.position }}-{{ forloop.index0 }}"
          name="{{ option_with_values.name }}"
        {% endif %}
        {% unless value.available %}
          class="disabled"
          {% if unselectable_when_unavailable %}
            disabled
          {% endif %}
        {% endunless %}
        type="radio"
        value="{{ value | escape }}"
        {% if product_form_id != null %}
          form="{{ product_form_id }}"
        {% endif %}
        {% if option_with_values.selected_value == value %}
          checked
        {% endif %}
        data-option-value-id="{{ value.id }}"
      >
      <label
        class="color color-{{ value | strip | downcase | replace: ' ', '-' }}"
        {% if in_mini %}
          for="Mini-{{ section_id }}-{{ option_with_values.position }}-{{ forloop.index0 }}"
        {% elsif in_bundle %}
          for="Bundle-{{ section_id }}-{{ option_with_values.position }}-{{ forloop.index0 }}"
        {% else %}
          for="{{ section_id }}-{{ option_with_values.position }}-{{ forloop.index0 }}"
        {% endif %}
        aria-label="{{ value }}"
        {%- if value.swatch != blank -%}
          style="background: {{ value.swatch.color }};"
        {%- endif -%}
      >
        {%- if type == 'image' -%}
          {%- if value.variant.image != blank -%}
            {{ value.variant.image | image_url: width: 60 | image_tag: loading: 'lazy' }}
          {%- else -%}
            {{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}
          {%- endif -%}
        {%- elsif value.swatch.image != blank and value.swatch != blank -%}
          {{ value.swatch.image | image_url: width: 60 | image_tag: loading: 'lazy' }}
        {%- endif -%}
      </label>
    </div>
  {%- elsif type == 'button' -%}
    <input
      {% if in_mini %}
        id="Mini-{{ section_id }}-{{ option_with_values.position }}-{{ forloop.index0 }}"
        name="_mini-{{ option_with_values.name }}"
        data-target="{{ section_id }}-{{ option_with_values.position }}-{{ forloop.index0 }}"
      {% elsif in_bundle %}
        id="Bundle-{{ section_id }}-{{ option_with_values.position }}-{{ forloop.index0 }}"
        name="_bundle-{{ option_with_values.name }}"
      {% else %}
        id="{{ section_id }}-{{ option_with_values.position }}-{{ forloop.index0 }}"
        name="{{ option_with_values.name }}"
      {% endif %}
      {% unless value.available %}
        class="disabled"
        {% if unselectable_when_unavailable %}
          disabled
        {% endif %}
      {% endunless %}
      type="radio"
      value="{{ value | escape }}"
      {% if product_form_id != null %}
        form="{{ product_form_id }}"
      {% endif %}
      {% if option_with_values.selected_value == value %}
        checked
      {% endif %}
      data-option-value-id="{{ value.id }}"
    >
    <label
      {% if in_mini %}
        for="Mini-{{ section_id }}-{{ option_with_values.position }}-{{ forloop.index0 }}"
      {% elsif in_bundle %}
        for="Bundle-{{ section_id }}-{{ option_with_values.position }}-{{ forloop.index0 }}"
      {% else %}
        for="{{ section_id }}-{{ option_with_values.position }}-{{ forloop.index0 }}"
      {% endif %}
    >
      {{- value -}}
    </label>
  {%- elsif type == 'dropdown' -%}
    <option
      value="{{ value | escape }}"
      {% if option_with_values.selected_value == value %}
        selected="selected"
      {% endif %}
      data-option-value-id="{{ value.id }}"
      {% unless value.available %}
        data-disabled
        {% if unselectable_when_unavailable %}
          disabled
        {% endif %}
      {% endunless %}
    >
      {{ value }}
      {%- unless value.available %}
        - {{ 'products.product.unavailable' | t }}
      {%- endunless -%}
    </option>
  {%- endif -%}
{%- endfor -%}
