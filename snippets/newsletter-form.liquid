{% doc %}
  Newsletter Form

  @description
  Renders a newsletter subscription form with optional style and consent notice.

  @param {string} section_id - Section Id
  @param {string} [class] - Custom CSS class (optional)
  @param {string} [style] - Form style: "normal", "line", "separate" (optional)
  @param {boolean} [show_consent_notice] - Whether to display a privacy consent notice (optional)

  @example
  {% render 'newsletter-form', section_id: section.id, style: 'line', show_consent_notice: true %}
{% enddoc %}

{% form 'customer', class: class %}
  <input type="hidden" name="contact[tags]" value="newsletter">
  <div class="newsletter-form-field-wrapper">
    {%- if form.errors -%}
      <div
        id="Newsletter-Error--{{ section_id }}"
        class="alert-message alert-error mb-2"
        role="alert"
        autofocus
        tabindex="-1"
      >
        {{ form.errors.messages.email }}
      </div>
    {% endif %}
    {%- if form.posted_successfully? -%}
      <div
        id="Newsletter-Success--{{ section_id }}"
        class="alert-message alert-success mb-2"
        role="alert"
        autofocus
        tabindex="-1"
      >
        {{ 'newsletter.success' | t }}
      </div>
    {%- endif -%}
    <div class="flexible-group">
      <div class="field field--{{ style | default: 'normal' }}">
        <input
          id="NewsletterForm--{{ section_id }}"
          type="email"
          name="contact[email]"
          class="field-input"
          value="{{ form.email }}"
          autocorrect="off"
          autocapitalize="off"
          autocomplete="email"
          pattern=".+@.+\.[a-zA-Z]{2,}$"
          title="{{ 'newsletter.valid_email' | t }}"
          {% if form.errors %}
            autofocus
            aria-invalid="true"
            aria-describedby="Newsletter-Error--{{ section_id }}"
          {% elsif form.posted_successfully? %}
            aria-describedby="Newsletter-Success--{{ section_id }}"
          {% endif %}
          placeholder="{{ 'newsletter.label' | t }}"
          required
        >
        <label class="field-label" for="NewsletterForm--{{ section_id }}">
          {{ 'newsletter.placeholder' | t }}
        </label>
        {% unless style == 'separate' %}
          <button
            type="submit"
            class="newsletter-form-button field-button"
            name="commit"
            aria-label="{{ 'newsletter.button_label' | t }}"
          >
            {% render 'icon-sets-basic', icon: 'right', class: 'caret-icon' %}
          </button>
        {% endunless %}
      </div>
      {%- if style == 'separate' -%}
        <button type="submit" class="separate-button button" name="commit">
          {{ 'newsletter.button_label' | t }}
          {% render 'icon-sets-basic', icon: 'right', class: 'caret-icon' %}
        </button>
      {%- endif -%}
    </div>
  </div>
  {%- if show_consent_notice -%}
    <div class="consent-notice light mt-2">{{ 'newsletter.consent_notice_html' | t }}</div>
  {%- endif -%}
{% endform %}
