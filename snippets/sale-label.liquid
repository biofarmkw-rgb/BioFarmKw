{% doc %}
  Sale Label

  @description
  This snippet renders a sale badge for a product or variant. You can choose the display type or render a simplified label without extra text.

  @param {object} target - Product or variant object
  @param {string} [type] - Display type: normal|amount|percentage
  @param {boolean} [simple] - Whether to render a simple label without additional text

  @example
  {% render 'sale-label', target: product %}
{% enddoc %}

{%- if target != blank -%}
  {% assign difference = target.compare_at_price | minus: target.price %}
{%- endif -%}
{%- if type == 'amount' -%}
  {%- if difference == blank -%}
    {% assign difference = 2000 %}
  {%- endif -%}
  {% assign difference_money = difference | money_without_trailing_zeros | strip_html %}

  {%- if simple -%}
    - {{ difference_money }}
    <span class="visually-hidden">{{ 'products.product.sale_amount' | t: amount: difference_money }}</span>
  {%- else -%}
    {{ 'products.product.sale_amount' | t: amount: difference_money }}
  {%- endif -%}
{%- elsif type == 'percentage' -%}
  {% if difference != blank %}
    {% assign percentage = difference | times: 100.0 | divided_by: target.compare_at_price | round: 0 %}
  {% else %}
    {% assign percentage = 20 %}
  {% endif %}

  {%- if simple -%}
    - {{ percentage }}%
    <span class="visually-hidden">{{ 'products.product.sale_percentage' | t: percentage: percentage }}</span>
  {%- else -%}
    {{ 'products.product.sale_percentage' | t: percentage: percentage }}
  {%- endif -%}
{%- else -%}
  {{ 'products.product.on_sale' | t }}
{%- endif -%}
